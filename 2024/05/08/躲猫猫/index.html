

<!DOCTYPE html>
<html lang="zn-CN">
<head>
  


<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CBCTF躲猫猫题解 [ Sorry yolbby ]</title>

  <link rel="icon" href="/img/favicon.ico">


    <meta name="author" content="yolbby">





  <link rel="alternate" href="/atom.xml " title="Sorry yolbby" type="application/atom+xml">


  
    <link rel="stylesheet" href="/css/main.css">
  

<meta name="generator" content="Hexo 7.1.1"></head>
  <body data-theme="light" class="notransition">
    <script>
      const body = document.body;
      const data = body.getAttribute("data-theme");
      const initTheme = (state) => {
        if (state === "dark") {
          body.setAttribute("data-theme", "dark");
        } else if (state === "light") {
          body.removeAttribute("data-theme");
        } else {
          localStorage.setItem("theme", data);
        }
      };
   
      initTheme(localStorage.getItem("theme"));
      
      setTimeout(() => body.classList.remove("notransition"), 75);
    </script>
  <div class="navbar" role="navigation">
    <nav class="menu">
      <input type="checkbox" id="menu-trigger" class="menu-trigger" />
      <label for="menu-trigger">
        <span class="menu-icon">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 512 512"
          >
            <path
              d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z"
            />
          </svg>
        </span>
      </label>
      <a id="mode">
        <svg
          class="mode-sunny"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <title>LIGHT</title>
          <line
            x1="256"
            y1="48"
            x2="256"
            y2="96"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="256"
            y1="416"
            x2="256"
            y2="464"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="108.92"
            x2="369.14"
            y2="142.86"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="369.14"
            x2="108.92"
            y2="403.08"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="464"
            y1="256"
            x2="416"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="96"
            y1="256"
            x2="48"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="403.08"
            x2="369.14"
            y2="369.14"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="142.86"
            x2="108.92"
            y2="108.92"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <circle
            cx="256"
            cy="256"
            r="80"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
        </svg>
        <svg
          class="mode-moon"
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 512 512"
        >
          <title>DARK</title>
          <line
            x1="256"
            y1="48"
            x2="256"
            y2="96"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="256"
            y1="416"
            x2="256"
            y2="464"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="108.92"
            x2="369.14"
            y2="142.86"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="369.14"
            x2="108.92"
            y2="403.08"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="464"
            y1="256"
            x2="416"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="96"
            y1="256"
            x2="48"
            y2="256"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="403.08"
            y1="403.08"
            x2="369.14"
            y2="369.14"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <line
            x1="142.86"
            y1="142.86"
            x2="108.92"
            y2="108.92"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
          <circle
            cx="256"
            cy="256"
            r="80"
            style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px"
          />
        </svg>
      </a>
      <div class="trigger">
        <div class="trigger-container">
          
            
            
            
            
            
            
            <a class="menu-link " href="/"> Home</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/about/"> About</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/archives/"> Archives</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/tags/"> Tags</a>
          
            
            
            
            
            
            
            <a class="menu-link " href="/links/"> Links</a>
          
        </div>
      </div>
    </nav>
  </div>
  
<div class="wrapper post">
  <main class="page-content" aria-label="Content">
      <header class="header">
        
          <div class="tags">
            <a href="/tags/WP/" class="tag"># WP</a>
          </div>
        
        <h1 class="header-title" itemprop="headline">CBCTF躲猫猫题解</h1>
          <div class="post-meta">
            <time>May 08, 2024</time>
            <span itemprop="author">
              <span itemprop="name">yolbby</span>
            </span>
          </div>
        </header>

          <div class="page-content"><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>拖了好久好久的题解，出完题整个人都会变得懒得复盘，可能出的时候都是一整个稀里糊涂的状态，想着怎么做到尽可能知识点简单&amp;有趣&amp;能做出筛选，但最终结果好像不是很尽如人意，四道题第一天就上了到最后也没什么人在看，算是整了盘大的。招新赛那天正在跨年，当时早上去老婆大人买了三大袋零食，下午一边双扣一边运维，看着其他方向的题矻矻被出，密码题无人问津，脑子都坏掉了。带着队友去吃了顿鸡啤咯哒以消解愁绪，也算过了个难忘的新年吧。</p>
<p>Anyway话不多说，就让厨师把一整道菜都端上来瞧瞧吧。</p>
<h2 id="躲猫猫1"><a href="#躲猫猫1" class="headerlink" title="躲猫猫1"></a>躲猫猫1</h2><blockquote>
<p>跨年夜当然少不了团建活动！</p>
<p>冬天雪花飘飘正适合玩躲猫猫，为配合赛博主题，0RAYS的每个队员身上都带着一小段flag，拼起来就可以兑换过年大礼包！你毛遂自荐作为抓捕者，于是队员们悄眯眯地藏起来了。</p>
<p>夜晚静悄悄的，你数完数踏出起点，影影绰绰看到几个人影……</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">humble_part, Ech0_part, Z3r0_part = flag[:<span class="built_in">len</span>(flag)//<span class="number">3</span>],flag[<span class="built_in">len</span>(flag)//<span class="number">3</span>:<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">3</span>],flag[<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">3</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment">#学活广场 humb1e似乎在旗杆背后探头探脑</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(humble_part))[<span class="number">2</span>:]</span><br><span class="line">R.&lt;humb1e&gt; = PolynomialRing(GF(getPrime(<span class="number">50</span>)))</span><br><span class="line">R = R.quo(humb1e^<span class="number">30</span>+random.randint(<span class="number">1</span>,<span class="number">2</span>^<span class="number">49</span>)*humb1e+<span class="number">1</span>)</span><br><span class="line">look_for_humb1e = [R(humb1e ^ (<span class="number">1500</span>*random.choice([<span class="built_in">ord</span>(<span class="string">&#x27;h&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;u&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;m&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;b&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;1&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;e&#x27;</span>)]))) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> R.random_element() <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"><span class="comment">#都放假了四教还亮着灯？抓到Ech0在躲猫猫的时候偷学密码！</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(Ech0_part))[<span class="number">2</span>:]</span><br><span class="line">look_for_Ech0 = [prod([j[<span class="number">0</span>]^(j[<span class="number">1</span>]-<span class="number">1</span>)*(j[<span class="number">0</span>]-<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> factor(random.getrandbits(<span class="number">100</span>))]) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> getPrime(<span class="number">100</span>)-<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"><span class="comment">#雪下得好大，花圃周围的亮白色身影是Z3r0吗</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(Z3r0_part))[<span class="number">2</span>:]</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">look_for_Z3r0 = [<span class="built_in">pow</span>(<span class="number">31137</span>,<span class="number">65537</span>,p*getPrime(<span class="number">512</span>)) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="built_in">pow</span>(<span class="number">31137</span>,<span class="number">65537</span>,getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(look_for_humb1e)</span><br><span class="line"><span class="built_in">print</span>(look_for_Ech0)</span><br><span class="line"><span class="built_in">print</span>(look_for_Z3r0)</span><br></pre></td></tr></table></figure>

<h3 id="humb1e’s-part"><a href="#humb1e’s-part" class="headerlink" title="humb1e’s part"></a>humb1e’s part</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#学活广场 humb1e似乎在旗杆背后探头探脑</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(humble_part))[<span class="number">2</span>:]</span><br><span class="line">R.&lt;humb1e&gt; = PolynomialRing(GF(getPrime(<span class="number">50</span>)))</span><br><span class="line">R = R.quo(humb1e^<span class="number">30</span>+random.randint(<span class="number">1</span>,<span class="number">2</span>^<span class="number">49</span>)*humb1e+<span class="number">1</span>)</span><br><span class="line">look_for_humb1e = [R(humb1e ^ (<span class="number">1500</span>*random.choice([<span class="built_in">ord</span>(<span class="string">&#x27;h&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;u&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;m&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;b&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;1&#x27;</span>),<span class="built_in">ord</span>(<span class="string">&#x27;e&#x27;</span>)]))) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> R.random_element() <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br></pre></td></tr></table></figure>

<p>Roll了一个多项式商环R，然后去在环上进行运算。令R函数表示随机，那么此时我们对于flag的不同位数，有<br>$$<br>flag[i]&#x3D;1:humb1e^{1500*R(h,u,m,b,1,e)}\<br>flag[i]&#x3D;0:Random \space element<br>$$<br>那么显然，在数据当中出现次数大于1次极有可能等价于flag[i]&#x3D;1（因为modulus的度有30），统计一下就可以恢复flag串。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">R.&lt;humb1ebar&gt; = PolynomialRing(ZZ)</span><br><span class="line">data = </span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;1&#x27;</span> <span class="keyword">if</span> data.count(data[i]) &gt; <span class="number">1</span> <span class="keyword">else</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>)))</span><br><span class="line"><span class="comment">#CBCTF&#123;H4ppy_N3wyear</span></span><br></pre></td></tr></table></figure>

<h3 id="Echo’s-part"><a href="#Echo’s-part" class="headerlink" title="Echo’s part"></a>Echo’s part</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#都放假了四教还亮着灯？抓到Ech0在躲猫猫的时候偷学密码！</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(Ech0_part))[<span class="number">2</span>:]</span><br><span class="line">look_for_Ech0 = [prod([j[<span class="number">0</span>]^(j[<span class="number">1</span>]-<span class="number">1</span>)*(j[<span class="number">0</span>]-<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> factor(random.getrandbits(<span class="number">100</span>))]) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> getPrime(<span class="number">100</span>)-<span class="number">1</span> <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br></pre></td></tr></table></figure>

<p>这个部分的处理更加清晰，即随机roll一个数、并计算它的欧拉函数，有<br>$$<br>flag[i]&#x3D;1:Φ(Random \space number)\<br>flag[i]&#x3D;0:Φ(Prime \space number)<br>$$<br>那么这个时候我们需要进行两层判断，第一层是判断所给数值加上一是否为素数，第二层是判断素数的bit数是否为100。代码如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data = </span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;0&#x27;</span> <span class="keyword">if</span> is_prime(data[i]+<span class="number">1</span>) <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(data[i]+<span class="number">1</span>)[<span class="number">2</span>:]) == <span class="number">100</span> <span class="keyword">else</span> <span class="string">&#x27;1&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>)))</span><br><span class="line"><span class="comment">#!Hope_y0u^can_h4ve_</span></span><br></pre></td></tr></table></figure>

<p>此时不排除随机数就是bit数为100的素数，因此可以debug得出正确的flag</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!Hope_y0u_can_h4ve_</span></span><br></pre></td></tr></table></figure>

<h3 id="Z3r0’s-part"><a href="#Z3r0’s-part" class="headerlink" title="Z3r0’s part"></a>Z3r0’s part</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#雪下得好大，花圃周围的亮白色身影是Z3r0吗</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(Z3r0_part))[<span class="number">2</span>:]</span><br><span class="line">p = getPrime(<span class="number">512</span>)</span><br><span class="line">look_for_Z3r0 = [<span class="built_in">pow</span>(<span class="number">31137</span>,<span class="number">65537</span>,p*getPrime(<span class="number">512</span>)) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="built_in">pow</span>(<span class="number">31137</span>,<span class="number">65537</span>,getPrime(<span class="number">512</span>)*getPrime(<span class="number">512</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br></pre></td></tr></table></figure>

<p>对于flag二进制位上的数字，令Q为随机素数，有<br>$$<br>flag[i]&#x3D;1:31337^{65537} \enspace mod \enspace p·Q\<br>flag[i]&#x3D;0:31337^{65537} \enspace mod \enspace Q_1·Q_2<br>$$<br>对于两个flag位等于1的数据$c_1,c_2$，有关系如下<br>$$<br>c_1&#x3D;31337^{65537}+k_1pQ_1\<br>c_2&#x3D;31337^{65537}+k_2pQ_2\<br>$$<br>因此可以利用关系<br>$$<br>c_1-c_2&#x3D;(k_1Q_1-k_2Q_2)p<br>$$<br>然后玩法就多了，可以考虑用gcd把p求出来然后求证每个数据在$GF(p)$上是否与$31337^{65537}$等价，这样在求出p以后每个数据都只用用一次。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">data = </span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="built_in">len</span>(data)):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(i+<span class="number">1</span>,<span class="built_in">len</span>(data)):</span><br><span class="line">        <span class="keyword">if</span> gcd(data[<span class="number">0</span>]-data[i],data[<span class="number">0</span>]-data[j]) &gt; <span class="number">2</span>^<span class="number">200</span>:</span><br><span class="line">            p = gcd(data[<span class="number">0</span>]-data[i],data[<span class="number">0</span>]-data[j])</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">            </span><br><span class="line"><span class="keyword">assert</span> is_prime(p)</span><br><span class="line"></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span>.join(<span class="string">&#x27;1&#x27;</span> <span class="keyword">if</span> data[i]%p == <span class="built_in">pow</span>(<span class="number">31137</span>,<span class="number">65537</span>,p) <span class="keyword">else</span> <span class="string">&#x27;0&#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(data)))</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(<span class="built_in">int</span>(flag,<span class="number">2</span>)))</span><br><span class="line"><span class="comment">#fun_1n_CBCTF_Juni0r&#125;</span></span><br></pre></td></tr></table></figure>

<h2 id="——————————有待更新·标记-5-9——————————"><a href="#——————————有待更新·标记-5-9——————————" class="headerlink" title="——————————有待更新·标记 5&#x2F;9——————————"></a>——————————有待更新·标记 5&#x2F;9——————————</h2><h2 id="躲猫猫2"><a href="#躲猫猫2" class="headerlink" title="躲猫猫2"></a>躲猫猫2</h2><blockquote>
<p>Humb1e，Ech0，Z3r0藏得都太草率了，显然没有把游戏放在心上。你语重心长地批评了他们一顿，踏上寻找其他人的旅途。</p>
<p>这下游戏就没有那么简单了。已经拿到一个新年大礼包的你能否再次创造奇迹呢？</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">gtg_part, beeee_part, Seg_Tree_part = flag[:<span class="built_in">len</span>(flag)//<span class="number">3</span>],flag[<span class="built_in">len</span>(flag)//<span class="number">3</span>:<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">3</span>],flag[<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">3</span>:]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#你惊异地发现，树丛里黑糊糊的枝叶居然有点神似gtg的辫子</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(gtg_part))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">matrix_crt</span>(<span class="params">mp,mq,p,q</span>):</span><br><span class="line">    m = matrix(Zmod(p*q),[[crt([<span class="built_in">int</span>(mp[i,j]),<span class="built_in">int</span>(mq[i,j])],[p,q]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)])</span><br><span class="line">    <span class="keyword">return</span> m</span><br><span class="line"></span><br><span class="line">p = getPrime(<span class="number">20</span>)</span><br><span class="line">a,b = MatrixGroup(matrix(GF(<span class="number">149</span>),[[<span class="number">41</span>,<span class="number">21</span>],[<span class="number">82</span>,<span class="number">81</span>]])),MatrixGroup(matrix(GF(<span class="number">163</span>),[[<span class="number">41</span>,<span class="number">21</span>],[<span class="number">82</span>,<span class="number">81</span>]]))</span><br><span class="line">ma,mb = a.gens()[<span class="number">0</span>],b.gens()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">look_for_gtg = [<span class="built_in">list</span>(matrix_crt(matrix(ZZ,ma^random.randint(<span class="number">1</span>,p)),matrix(ZZ,mb^random.randint(<span class="number">1</span>,p)),<span class="number">149</span>,<span class="number">163</span>)) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="built_in">list</span>(matrix(Zmod(<span class="number">149</span>*<span class="number">163</span>),[[random.randint(<span class="number">1</span>,<span class="number">149</span>*<span class="number">163</span>)<span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)] <span class="keyword">for</span> __ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span>)])) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#前两天刚考完研，图书馆难得清静，你在9楼搜寻，只见角落闪烁着微光。好像是beeee！</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(beeee_part))[<span class="number">2</span>:]</span><br><span class="line">m,p = getPrime(<span class="number">1023</span>),getPrime(<span class="number">1024</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ppallier</span>(<span class="params">m,p</span>):</span><br><span class="line">    c = <span class="built_in">pow</span>(p+<span class="number">1</span>,getPrime(<span class="number">40</span>)*m,p^<span class="number">2</span>)*<span class="built_in">pow</span>(random.randint(<span class="number">1</span>,p^<span class="number">2</span>-<span class="number">1</span>),p,p^<span class="number">2</span>)%p^<span class="number">2</span></span><br><span class="line">    <span class="keyword">return</span> c</span><br><span class="line"></span><br><span class="line">look_for_beeee = [<span class="built_in">pow</span>(ppallier(m,p),p-<span class="number">1</span>,p^<span class="number">2</span>) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> random.randint(<span class="number">1</span>,p^<span class="number">2</span>-<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#看上去有人卡视野藏在协会天台上。你走了过去，Seg_Tree正在假装自己是一颗树。</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(Seg_Tree_part))[<span class="number">2</span>:]</span><br><span class="line">look_for_Seg_Tree = [AES.new(key = os.urandom(<span class="number">16</span>),mode = AES.MODE_CFB,iv = os.urandom(<span class="number">16</span>)).decrypt((os.urandom(<span class="number">16</span>)*<span class="number">3</span>)[:<span class="number">33</span>]) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> AES.new(key = os.urandom(<span class="number">16</span>),mode = AES.MODE_CFB,iv = os.urandom(<span class="number">16</span>)).encrypt((os.urandom(<span class="number">16</span>)*<span class="number">3</span>)[:<span class="number">33</span>]) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(look_for_gtg)</span><br><span class="line"><span class="built_in">print</span>(look_for_beeee)</span><br><span class="line"><span class="built_in">print</span>(look_for_Seg_Tree)</span><br></pre></td></tr></table></figure>



<h2 id="躲猫猫3"><a href="#躲猫猫3" class="headerlink" title="躲猫猫3"></a>躲猫猫3</h2><blockquote>
<p>你花了点力气找到了gtg，beeee和Seg_Tree。手握两份新年礼包的你显然已经是整个协会中最富有的哥们儿，你一边畅想着未来的幸福生活和完美外设一边哼哧瘪肚在冬日里前行。</p>
<p>剩下的人都是难找的茬子啊……</p>
<p>不过你坚信这一切难不倒你。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">Art0ne_part, 奶茶_part, _1manity_part = flag[:<span class="built_in">len</span>(flag)//<span class="number">3</span>],flag[<span class="built_in">len</span>(flag)//<span class="number">3</span>:<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">3</span>],flag[<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">3</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment">#Art0ne偷溜进体育馆，在走廊的一个拐角随时准备逃跑。你抓住他时自己已经要累得不行了。</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(Art0ne_part))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p,q</span><br><span class="line">n = <span class="number">7589728368000360290382663172234488251897043335410016881502715294598442607646158403453736522549655542481555536223060519309001243744487805230719883633463721</span></span><br><span class="line"><span class="keyword">assert</span> n == p * q <span class="keyword">and</span> isPrime(p) <span class="keyword">and</span> isPrime(q) <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(p)) == <span class="number">258</span> <span class="keyword">and</span> <span class="built_in">len</span>(<span class="built_in">bin</span>(q)) == <span class="number">258</span></span><br><span class="line"></span><br><span class="line">R.&lt;x&gt; = PolynomialRing(Zmod(n))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">roll</span>(<span class="params">mode,i</span>):</span><br><span class="line">    <span class="keyword">if</span> mode == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> random.randint(<span class="number">1</span>,p*q-<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x,y = random.randint(<span class="number">1</span>,<span class="number">2</span>^<span class="number">80</span>),random.randint(<span class="number">1</span>,<span class="number">2</span>^<span class="number">256</span>)*p</span><br><span class="line">        <span class="keyword">return</span> R(x+x*y^<span class="number">2</span>+y*x^<span class="number">3</span>)</span><br><span class="line">    </span><br><span class="line">look_for_Art0ne = [roll(<span class="number">1</span>,i) <span class="keyword">if</span> secret[i] == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> roll(<span class="number">0</span>,i) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#你找遍了学校，最后在弗雷德二店的古茗二楼意外找到了奶茶并宣判他犯规</span></span><br><span class="line">secret = bytes_to_long(奶茶_part)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shuffle</span>(<span class="params">ll,lr</span>):</span><br><span class="line">    a = [<span class="string">&#x27;0&#x27;</span>]*<span class="built_in">len</span>(奶茶_part)*ll+[<span class="string">&#x27;1&#x27;</span>]*<span class="built_in">len</span>(奶茶_part)*lr</span><br><span class="line">    random.shuffle(a)</span><br><span class="line">    <span class="keyword">return</span> a</span><br><span class="line"></span><br><span class="line">look_for_奶茶 = [<span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(shuffle(<span class="number">5</span>,<span class="number">3</span>)),<span class="number">2</span>)^^secret <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(shuffle(<span class="number">3</span>,<span class="number">5</span>)),<span class="number">2</span>)^^secret <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">bin</span>(secret)[<span class="number">2</span>:].rjust(<span class="number">8</span>*<span class="built_in">len</span>(奶茶_part),<span class="string">&#x27;0&#x27;</span>)]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#1manity藏在师生驿站，跨年夜店里没有值班，乌漆嘛黑的还带个笨蛋智能门锁，要不是你渴了进去买杯饮料还真的找不到他</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(_1manity_part))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">p = <span class="number">13692367685268431611</span></span><br><span class="line">x = [matrix(GF(p),<span class="number">4</span>,<span class="number">4</span>,[random.randint(<span class="number">1</span>,p-<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">7</span>)]</span><br><span class="line"></span><br><span class="line">look_for_1manity = [<span class="built_in">list</span>(<span class="built_in">sum</span>(random.randint(<span class="number">1</span>,p-<span class="number">1</span>)*j <span class="keyword">for</span> j <span class="keyword">in</span> x)) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> <span class="built_in">list</span>(matrix(GF(p),<span class="number">4</span>,<span class="number">4</span>,[random.randint(<span class="number">1</span>,p-<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">16</span>)])) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(look_for_Art0ne)</span><br><span class="line"><span class="built_in">print</span>(look_for_奶茶)</span><br><span class="line"><span class="built_in">print</span>(look_for_1manity)</span><br></pre></td></tr></table></figure>



<h2 id="躲猫猫4"><a href="#躲猫猫4" class="headerlink" title="躲猫猫4"></a>躲猫猫4</h2><blockquote>
<p>说来奇怪，在1manity，Art0ne和奶茶之后，你找遍了一整个学校都没能找到剩下的人，只能启动planB，使用你长期修炼凝结而成的密码解析技巧去把他们的参数调出来一一分析。</p>
<p>你以为你稳操胜券，但定睛一看，JBNRZ居然开了外挂卡在墙的里面！</p>
<p>他也把misc技巧带出了虚拟世界！</p>
<p>这个发现震惊了你的世界观，随着你打开每个人的视角偷看他们的位置，你的下巴不知不觉掉到了地上。</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> flag</span><br><span class="line"></span><br><span class="line">JBNRZ_part, pankas_part, v0id_part = flag[:<span class="built_in">len</span>(flag)//<span class="number">3</span>],flag[<span class="built_in">len</span>(flag)//<span class="number">3</span>:<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">3</span>],flag[<span class="number">2</span>*<span class="built_in">len</span>(flag)//<span class="number">3</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment">#JBNRZ开了修改器把自己卡在七教二楼阳台的墙壁中间。你就算知道他在哪，也没法摸到他。</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(JBNRZ_part))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">q = <span class="number">0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaab</span></span><br><span class="line">r = <span class="number">0x73eda753299d7d483339d80809a1d80553bda402fffe5bfeffffffff00000001</span></span><br><span class="line">k = GF(r)(q).multiplicative_order()</span><br><span class="line">F = GF(q)</span><br><span class="line">K2.&lt;x&gt; = PolynomialRing(F)</span><br><span class="line">F2.&lt;u&gt; = F.extension(x^<span class="number">2</span>+<span class="number">1</span>)</span><br><span class="line">E2 = EllipticCurve(F2, [<span class="number">0</span>, <span class="number">4</span>+<span class="number">4</span>*u])</span><br><span class="line">o = E2.order()</span><br><span class="line"></span><br><span class="line">P = E2.random_element()*(o//r)</span><br><span class="line">Q = E2.random_element()*(o//r)</span><br><span class="line">R = E2.random_element()*(o//r)</span><br><span class="line">S = E2.random_element()*(o//r)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">random_gen_fg</span>(<span class="params">P,Q,R,S</span>):</span><br><span class="line">    P,Q,R,S = random.randint(<span class="number">1</span>,r-<span class="number">1</span>)*P,random.randint(<span class="number">1</span>,r-<span class="number">1</span>)*Q,random.randint(<span class="number">1</span>,r-<span class="number">1</span>)*R,random.randint(<span class="number">1</span>,r-<span class="number">1</span>)*S</span><br><span class="line">    f1 = (P._miller_(Q+S,r))</span><br><span class="line">    f2 = (P._miller_(S,r))</span><br><span class="line">    g1 = (Q._miller_(P+R,r))</span><br><span class="line">    g2 = (Q._miller_(R,r))</span><br><span class="line">    <span class="keyword">return</span> P.weil_pairing(Q,r)+(f1/f2*g2/g1)</span><br><span class="line"></span><br><span class="line">look_for_JBNRZ = [random_gen_fg(P,Q,R,S) <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> random.randint(<span class="number">1</span>,q-<span class="number">1</span>)*u+random.randint(<span class="number">1</span>,q-<span class="number">1</span>) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#pankas用注释符把自己注释掉了，你必须使用一些过滤手段停止他的作弊行为。</span></span><br><span class="line">secret = bytes_to_long(pankas_part)</span><br><span class="line"></span><br><span class="line">p = <span class="number">567811</span></span><br><span class="line">F = GF(p)</span><br><span class="line">n, k, r= <span class="number">16</span>, <span class="number">10</span>, <span class="number">6</span></span><br><span class="line">t = n//<span class="number">4</span></span><br><span class="line"></span><br><span class="line">C = codes.GeneralizedReedSolomonCode([F(_+<span class="number">1</span>) <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)],k)</span><br><span class="line">S = matrix(F,r,r,[(<span class="number">155790</span>, <span class="number">486108</span>, <span class="number">98452</span>, <span class="number">364639</span>, <span class="number">120720</span>, <span class="number">313488</span>), (<span class="number">100323</span>, <span class="number">367952</span>, <span class="number">158314</span>, <span class="number">537951</span>, <span class="number">1368</span>, <span class="number">437409</span>), (<span class="number">24424</span>, <span class="number">3563</span>, <span class="number">165622</span>, <span class="number">226117</span>, <span class="number">268381</span>, <span class="number">281060</span>), (<span class="number">306717</span>, <span class="number">437800</span>, <span class="number">498491</span>, <span class="number">454109</span>, <span class="number">45791</span>, <span class="number">427166</span>), (<span class="number">440079</span>, <span class="number">197166</span>, <span class="number">514113</span>, <span class="number">24595</span>, <span class="number">172079</span>, <span class="number">106605</span>), (<span class="number">529695</span>, <span class="number">239369</span>, <span class="number">361569</span>, <span class="number">565415</span>, <span class="number">72455</span>, <span class="number">244407</span>)])</span><br><span class="line">H_ = S*C.parity_check_matrix()*matrix(Permutations(n).random_element())</span><br><span class="line"></span><br><span class="line">s = [<span class="built_in">sorted</span>(random.sample([_ <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(n)],t-<span class="number">1</span>)) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret))]</span><br><span class="line">look_for_pankas = [H_*vector([random.randint(<span class="number">1</span>,<span class="number">32</span>) <span class="keyword">if</span> j <span class="keyword">in</span> s[i] <span class="keyword">else</span> <span class="number">0</span> <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(n)]) <span class="keyword">if</span> secret[i] == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> vector([random.randint(<span class="number">1</span>,p-<span class="number">1</span>) <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>)]) <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(secret))]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#v0id通过某些方法修改了自己的人体结构，看上去需要经历一些反混淆反编译才能重现世间。</span></span><br><span class="line">secret = <span class="built_in">bin</span>(bytes_to_long(v0id_part))[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line">F = GF(<span class="number">2</span> ** <span class="number">256</span>, <span class="string">&#x27;z&#x27;</span>)</span><br><span class="line">z = F.gens()[<span class="number">0</span>]</span><br><span class="line">P = PolynomialRing(F, <span class="string">&#x27;u, v&#x27;</span>)</span><br><span class="line">u, v = P.gens()</span><br><span class="line">PP.&lt;x&gt; = PolynomialRing(F)</span><br><span class="line">x = PP.gens()[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line">h = u^<span class="number">2</span> + u</span><br><span class="line">f = u^<span class="number">5</span> + u^<span class="number">3</span> + <span class="number">1</span></span><br><span class="line">on_curve = v^<span class="number">2</span> + h*v - f</span><br><span class="line">h,f = h(u=x),f(u=x)</span><br><span class="line"></span><br><span class="line">H = HyperellipticCurve(f, h)</span><br><span class="line">J = H.jacobian()</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">init</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            plain = random.randint(<span class="number">1</span>,<span class="number">2</span>^<span class="number">256</span>)</span><br><span class="line">            xx = F.fetch_int(plain)</span><br><span class="line">            y, k = on_curve(u=xx, v=x).roots()[<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">assert</span> k == <span class="number">1</span></span><br><span class="line">            <span class="keyword">return</span> - xx, y</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line"></span><br><span class="line">look_for_v0id = [(<span class="number">3</span>*J(H(init())))[<span class="number">0</span>] <span class="keyword">if</span> i == <span class="string">&#x27;1&#x27;</span> <span class="keyword">else</span> random.choice([(<span class="number">7</span>*J(H(init())))[<span class="number">0</span>],x^<span class="number">2</span>+F.fetch_int(random.randint(<span class="number">1</span>,<span class="number">2</span>^<span class="number">256</span>))*x+F.fetch_int(random.randint(<span class="number">1</span>,<span class="number">2</span>^<span class="number">256</span>))]) <span class="keyword">for</span> i <span class="keyword">in</span> secret]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(look_for_JBNRZ)</span><br><span class="line"><span class="built_in">print</span>(look_for_pankas)</span><br><span class="line"><span class="built_in">print</span>(look_for_v0id)</span><br></pre></td></tr></table></figure>

</div>
          <nav class="post-nav">
    
    
    <a class="post-nav-item post-nav-next" href="/2024/03/25/hello-world/">
      <div class="nav-arrow">OLDER&nbsp;&gt;</div>
      <span class="post-title">Hello World</span>
    </a>
    
  </nav>

   </main>
</div>

  <footer class="footer">
    <small class="footer_copyright">
      <div id="bottom-inner">
        © 2021 Site by yolbby using
        <a target="_blank" rel="noopener" href="http://hexo.io">hexo blog framework</a>.
        <br>
        <p> Theme is <a target="_blank" rel="noopener" href="https://github.com/dewjohn/hexo-theme-klise">Klise</a></p>
      </div>
    </small>
  </footer>
  
  

    
      <script src="/js/main.js"></script>
    
  
  <script>
    window.FPConfig = {
      delay: 0,
      ignoreKeywords: [],
      maxRPS: 3,
      hoverDelay: 50,
    };
  </script>
  <script defer src="https://cdn.jsdelivr.net/gh/gijo-varghese/flying-pages@2.1.2/flying-pages.min.js"></script>
</body>
</html>
